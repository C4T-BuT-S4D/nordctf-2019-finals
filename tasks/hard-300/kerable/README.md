# Hard-300 | Pwn | Kerable

## Информация

> Здесь всё просто: если сможете убедить систему, что вы настоящий Кер, то получите флаг.
>
> Флаг лежит в `/tmp/flag.txt`
> 
> `nc address 33063`


## Запуск

```sh
docker-compose up --build -d
```


## Описание

В таске предлагается пройти авторизацию, введя верные логин и пароль. Сервис _сомневается_ в том, что пользователь является тем, за кого себя выдаёт, поэтому даже после ввода верных данных флаг получить нельзя.


## Решение

Нужно заметить, что для чтения логина и пароля используется функция [`scanf`](https://www.opennet.ru/man.shtml?topic=scanf&category=3&russian=0), которая при использовании формата `%Ns` оставляет нулевой байт __после__ конца буфера длины `N`, то есть на следующей после буфера позиции. Это значит, что мы имеем дело с однобайтовым переполнением буфера. Канарейка отсутствует, поэтому нулевой байт записывается в BP, сохранённый на стеке, который в будущем повлияет на адрес возврата из родительской функции `main`. Роп-цепочку можно построить во вводимом буфере, добавив в начале `ret sled`, чтобы можно было прыгать на любую позицию в буфере до самой цепочки.

[Пример эксплоита](exploit.py)


## Флаг

Флаг лежит в файле [service/flag.txt](service/flag.txt).

`flag{i_am_not_sure_that_you_are_the_real_ker_but_nice_try}`
