# Hard-400 | Forensic/Network/Crypto | Do you know the way?

## Информация

> Скоро мемы будут под запертом! Некоторые энтузиасты уже сейчас передают их хитрым образом. Они используют криптоконтейнеры, вшивают данные в прошивки различных сетевых устройств и делают ещё много чего.
> Сможешь ты разгадать эту сложную схему?
> <File links>


## Запуск

Отдать участникам два файла.

## Описание

Дан дамп трафика и неопознаный файл на 50 Мб

## Решение
Решение состоит из нескольких этапов.
1. В трафике находим странный TCP-стрим внутри которого есть какие-то мемные словечки, а также 64 байта сырых данных. Можно предположить, что это какой-то хеш. По размеру подойдёт тольк sha512. Проверим хеш по базам и получим, что это хеш от слова "kernel"
2. В описании были намёки на криптоконтейнеры. Второй файл это и есть контейнер. Пароль от него это слово "kernel"
3. Внутри контейнера прошивка для DIR-300 с пересобранной FS. Распаковка не занимает много времени и сложности, в итоге получаем полный доступ к FS
4. В FS в папке /var/log лежит файл .dump, который являлся USB-дампом клавиатуры. Внутри дампа разработка питон скрипта для шифрования архива
5. В /etc лежал файл .secret.enc который и был зашифрован скриптом.
6. Скрипт очень простой, он осуществляет XOR по заложенным ключам и сжимает всё с помощью алгоритма LZC
7. Пишем обратный скрипт и получаем архив
8. Внутри архива PNG с обрезаными границами, увеличиваем высоту и получаем флаг

## Флаг

`flag{a63bedadc546b84a38cbe6f0329d6f2e}`
